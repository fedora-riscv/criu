From 88caa7a5083039157f340df1497fc7a6c91a9174 Mon Sep 17 00:00:00 2001
From: Radostin Stoyanov <rstoyanov@fedoraproject.org>
Date: Sun, 15 Aug 2021 11:29:22 +0100
Subject: [PATCH 150/245] ci: run criu-config tests

Signed-off-by: Radostin Stoyanov <rstoyanov@fedoraproject.org>
---
 scripts/ci/run-ci-tests.sh | 3 +++
 test/Makefile              | 5 +++++
 2 files changed, 8 insertions(+)

diff --git a/scripts/ci/run-ci-tests.sh b/scripts/ci/run-ci-tests.sh
index 50216634e..5ef3965db 100755
--- a/scripts/ci/run-ci-tests.sh
+++ b/scripts/ci/run-ci-tests.sh
@@ -202,6 +202,9 @@ fi
 # shellcheck disable=SC2086
 ./test/zdtm.py run -a -p 2 --keep-going $ZDTM_OPTS
 
+# shellcheck disable=SC2086
+./test/zdtm.py run -a -p 2 --keep-going --criu-config $ZDTM_OPTS
+
 # Newer kernels are blocking access to userfaultfd:
 # uffd: Set unprivileged_userfaultfd sysctl knob to 1 if kernel faults must be handled without obtaining CAP_SYS_PTRACE capability
 if [ -e /proc/sys/vm/unprivileged_userfaultfd ]; then
diff --git a/test/Makefile b/test/Makefile
index 9938015e0..8416b1961 100644
--- a/test/Makefile
+++ b/test/Makefile
@@ -5,6 +5,7 @@ export ZDTM_ARGS
 
 all:
 	$(MAKE) zdtm
+	$(MAKE) zdtm-config
 	$(MAKE) zdtm-pre-dump
 	$(MAKE) zdtm-snapshot
 	$(MAKE) zdtm-iter
@@ -23,6 +24,10 @@ zdtm:
 	./zdtm.py run -a --parallel 2
 .PHONY: zdtm
 
+zdtm-config:
+	./zdtm.py run -a --parallel 2 --criu-config
+.PHONY: zdtm-config
+
 zdtm-pre-dump:
 	./zdtm.py run --pre 2:1 -t zdtm/transition/fork -f uns
 .PHONY: zdtm-pre-dump
-- 
2.35.1

